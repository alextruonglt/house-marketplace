{"ast":null,"code":"import{useState,useEffect}from\"react\";import{Link,useNavigate,useParams}from\"react-router-dom\";import{Helmet}from\"react-helmet\";import{MapContainer,Marker,Popup,TileLayer}from\"react-leaflet\";import SwiperCore,{Navigation,Pagination,Scrollbar,A11y}from\"swiper\";import{Swiper,SwiperSlide}from\"swiper/react\";import\"swiper/swiper-bundle.css\";import{getDoc,doc}from\"firebase/firestore\";import{getAuth}from\"firebase/auth\";import{db}from\"../firebase.config\";import Spinner from\"../components/Spinner\";import shareIcon from\"../assets/svg/shareIcon.svg\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";SwiperCore.use([Navigation,Pagination,Scrollbar,A11y]);function Listing(){var _auth$currentUser;const[listing,setListing]=useState(null);const[loading,setLoading]=useState(true);const[shareLinkCopied,setShareLinkCopied]=useState(false);const navigate=useNavigate();const params=useParams();const auth=getAuth();useEffect(()=>{const fetchListing=async()=>{const docRef=doc(db,\"listings\",params.listingId);const docSnap=await getDoc(docRef);if(docSnap.exists()){setListing(docSnap.data());setLoading(false);}};fetchListing();},[navigate,params.listingId]);if(loading){return/*#__PURE__*/_jsx(Spinner,{});}return/*#__PURE__*/_jsxs(\"main\",{children:[/*#__PURE__*/_jsx(Helmet,{children:/*#__PURE__*/_jsx(\"title\",{children:listing.name})}),/*#__PURE__*/_jsx(Swiper,{slidesPerView:1,pagination:{clickable:true},children:listing.imgUrls.map((url,index)=>/*#__PURE__*/_jsx(SwiperSlide,{children:/*#__PURE__*/_jsx(\"div\",{style:{background:\"url(\".concat(listing.imgUrls[index],\") center no-repeat\"),backgroundSize:\"cover\"},className:\"swiperSlideDiv\"})},index))}),/*#__PURE__*/_jsx(\"div\",{className:\"shareIconDiv\",onClick:()=>{navigator.clipboard.writeText(window.location.href);setShareLinkCopied(true);setTimeout(()=>{setShareLinkCopied(false);},2000);},children:/*#__PURE__*/_jsx(\"img\",{src:shareIcon,alt:\"\"})}),shareLinkCopied&&/*#__PURE__*/_jsx(\"p\",{className:\"linkCopied\",children:\"Link Copied!\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"listingDetails\",children:[/*#__PURE__*/_jsxs(\"p\",{className:\"listingName\",children:[listing.name,\" - $\",listing.offer?listing.discountedPrice.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g,\",\"):listing.regularPrice.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g,\",\")]}),/*#__PURE__*/_jsx(\"p\",{className:\"listingLocation\",children:listing.location}),/*#__PURE__*/_jsxs(\"p\",{className:\"listingType\",children:[\"For \",listing.type===\"rent\"?\"Rent\":\"Sale\"]}),listing.offer&&/*#__PURE__*/_jsxs(\"p\",{className:\"discountPrice\",children:[\"$\",listing.regularPrice-listing.discountedPrice,\" discount\"]}),/*#__PURE__*/_jsxs(\"ul\",{className:\"listingDetailsList\",children:[/*#__PURE__*/_jsx(\"li\",{children:listing.bedrooms>1?\"\".concat(listing.bedrooms,\" Bedrooms\"):\"1 Bedroom\"}),/*#__PURE__*/_jsx(\"li\",{children:listing.bathrooms>1?\"\".concat(listing.bathrooms,\" Bathrooms\"):\"1 Bathroom\"}),/*#__PURE__*/_jsx(\"li\",{children:listing.parking&&\"Parking Spot\"}),/*#__PURE__*/_jsx(\"li\",{children:listing.furnished&&\"Furnished\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"listingLocationTitle\",children:\"Location\"}),/*#__PURE__*/_jsx(\"div\",{className:\"leafletContainer\",children:/*#__PURE__*/_jsxs(MapContainer,{style:{height:\"100%\",width:\"100%\"},center:[listing.geolocation.lat,listing.geolocation.lng],zoom:13,scrollWheelZoom:false,children:[/*#__PURE__*/_jsx(TileLayer,{attribution:\"\\xA9 <a href=\\\"http://osm.org/copyright\\\">OpenStreetMap</a> contributors\",url:\"https://{s}.tile.openstreetmap.de/tiles/osmde/{z}/{x}/{y}.png\"}),/*#__PURE__*/_jsx(Marker,{position:[listing.geolocation.lat,listing.geolocation.lng],children:/*#__PURE__*/_jsx(Popup,{children:listing.location})})]})}),((_auth$currentUser=auth.currentUser)===null||_auth$currentUser===void 0?void 0:_auth$currentUser.uid)!==listing.userRef&&/*#__PURE__*/_jsx(Link,{to:\"/contact/\".concat(listing.userRef,\"?listingName=\").concat(listing.name),className:\"primaryButton\",children:\"Contact Landlord\"})]})]});}export default Listing;","map":{"version":3,"names":["useState","useEffect","Link","useNavigate","useParams","Helmet","MapContainer","Marker","Popup","TileLayer","SwiperCore","Navigation","Pagination","Scrollbar","A11y","Swiper","SwiperSlide","getDoc","doc","getAuth","db","Spinner","shareIcon","jsx","_jsx","jsxs","_jsxs","use","Listing","_auth$currentUser","listing","setListing","loading","setLoading","shareLinkCopied","setShareLinkCopied","navigate","params","auth","fetchListing","docRef","listingId","docSnap","exists","data","children","name","slidesPerView","pagination","clickable","imgUrls","map","url","index","style","background","concat","backgroundSize","className","onClick","navigator","clipboard","writeText","window","location","href","setTimeout","src","alt","offer","discountedPrice","toString","replace","regularPrice","type","bedrooms","bathrooms","parking","furnished","height","width","center","geolocation","lat","lng","zoom","scrollWheelZoom","attribution","position","currentUser","uid","userRef","to"],"sources":["/Users/alextruong/Documents/Coding/house-marketplace/src/pages/Listing.js"],"sourcesContent":["import { useState, useEffect } from \"react\"\nimport { Link, useNavigate, useParams } from \"react-router-dom\"\nimport { Helmet } from \"react-helmet\"\nimport { MapContainer, Marker, Popup, TileLayer } from \"react-leaflet\"\nimport SwiperCore, { Navigation, Pagination, Scrollbar, A11y } from \"swiper\"\nimport { Swiper, SwiperSlide } from \"swiper/react\"\nimport \"swiper/swiper-bundle.css\"\nimport { getDoc, doc } from \"firebase/firestore\"\nimport { getAuth } from \"firebase/auth\"\nimport { db } from \"../firebase.config\"\nimport Spinner from \"../components/Spinner\"\nimport shareIcon from \"../assets/svg/shareIcon.svg\"\nSwiperCore.use([Navigation, Pagination, Scrollbar, A11y])\n\nfunction Listing() {\n  const [listing, setListing] = useState(null)\n  const [loading, setLoading] = useState(true)\n  const [shareLinkCopied, setShareLinkCopied] = useState(false)\n\n  const navigate = useNavigate()\n  const params = useParams()\n  const auth = getAuth()\n\n  useEffect(() => {\n    const fetchListing = async () => {\n      const docRef = doc(db, \"listings\", params.listingId)\n      const docSnap = await getDoc(docRef)\n\n      if (docSnap.exists()) {\n        setListing(docSnap.data())\n        setLoading(false)\n      }\n    }\n\n    fetchListing()\n  }, [navigate, params.listingId])\n\n  if (loading) {\n    return <Spinner />\n  }\n\n  return (\n    <main>\n      <Helmet>\n        <title>{listing.name}</title>\n      </Helmet>\n      <Swiper slidesPerView={1} pagination={{ clickable: true }}>\n        {listing.imgUrls.map((url, index) => (\n          <SwiperSlide key={index}>\n            <div\n              style={{\n                background: `url(${listing.imgUrls[index]}) center no-repeat`,\n                backgroundSize: \"cover\",\n              }}\n              className=\"swiperSlideDiv\"\n            ></div>\n          </SwiperSlide>\n        ))}\n      </Swiper>\n\n      <div\n        className=\"shareIconDiv\"\n        onClick={() => {\n          navigator.clipboard.writeText(window.location.href)\n          setShareLinkCopied(true)\n          setTimeout(() => {\n            setShareLinkCopied(false)\n          }, 2000)\n        }}\n      >\n        <img src={shareIcon} alt=\"\" />\n      </div>\n\n      {shareLinkCopied && <p className=\"linkCopied\">Link Copied!</p>}\n\n      <div className=\"listingDetails\">\n        <p className=\"listingName\">\n          {listing.name} - $\n          {listing.offer\n            ? listing.discountedPrice\n                .toString()\n                .replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\")\n            : listing.regularPrice\n                .toString()\n                .replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\")}\n        </p>\n        <p className=\"listingLocation\">{listing.location}</p>\n        <p className=\"listingType\">\n          For {listing.type === \"rent\" ? \"Rent\" : \"Sale\"}\n        </p>\n        {listing.offer && (\n          <p className=\"discountPrice\">\n            ${listing.regularPrice - listing.discountedPrice} discount\n          </p>\n        )}\n\n        <ul className=\"listingDetailsList\">\n          <li>\n            {listing.bedrooms > 1\n              ? `${listing.bedrooms} Bedrooms`\n              : \"1 Bedroom\"}\n          </li>\n          <li>\n            {listing.bathrooms > 1\n              ? `${listing.bathrooms} Bathrooms`\n              : \"1 Bathroom\"}\n          </li>\n          <li>{listing.parking && \"Parking Spot\"}</li>\n          <li>{listing.furnished && \"Furnished\"}</li>\n        </ul>\n\n        <p className=\"listingLocationTitle\">Location</p>\n\n        <div className=\"leafletContainer\">\n          <MapContainer\n            style={{ height: \"100%\", width: \"100%\" }}\n            center={[listing.geolocation.lat, listing.geolocation.lng]}\n            zoom={13}\n            scrollWheelZoom={false}\n          >\n            <TileLayer\n              attribution='&copy; <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors'\n              url=\"https://{s}.tile.openstreetmap.de/tiles/osmde/{z}/{x}/{y}.png\"\n            />\n\n            <Marker\n              position={[listing.geolocation.lat, listing.geolocation.lng]}\n            >\n              <Popup>{listing.location}</Popup>\n            </Marker>\n          </MapContainer>\n        </div>\n\n        {auth.currentUser?.uid !== listing.userRef && (\n          <Link\n            to={`/contact/${listing.userRef}?listingName=${listing.name}`}\n            className=\"primaryButton\"\n          >\n            Contact Landlord\n          </Link>\n        )}\n      </div>\n    </main>\n  )\n}\n\nexport default Listing\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}